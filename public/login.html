<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login | Washington D.C.</title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:'Kanit',sans-serif;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:url("pic/dc_sunset.png") no-repeat center center/cover;
}

.login-container{
    width:420px;
    background:rgba(10,0,25,0.85);
    border-radius:26px;
    padding:38px;
    text-align:center;
    color:white;
    box-shadow:0 0 38px rgba(255,140,30,0.35);
    animation:fadein .6s ease-out;
}
@keyframes fadein{
    from{opacity:0;transform:translateY(18px);}
    to{opacity:1;transform:translateY(0);}
}

h2{
    font-size:34px;margin-bottom:22px;
    background:linear-gradient(90deg,#ffd089,#ff8a25);
    -webkit-background-clip:text;color:transparent;
    font-weight:800;
}

input{
    width:100%;padding:13px;margin:10px 0;
    border-radius:10px;border:none;outline:none;
    font-size:17px;color:#333;
}

button{
    width:100%;padding:13px;
    background:linear-gradient(90deg,#ffe29c,#ff8522);
    border:none;border-radius:12px;
    font-size:18px;font-weight:bold;
    cursor:pointer;margin-top:12px;
    transition:.25s;color:#222;
}
button:hover{
    transform:scale(1.05);
    box-shadow:0 0 26px rgba(255,140,30,0.85);
}

.forgot{
    display:block;text-align:right;
    margin-top:0;margin-bottom:10px;
    font-size:14px;color:#ffd28a;
}

.register-box{margin-top:18px;font-size:15px;}
.register-box a{
    display:inline-block;margin-left:6px;
    padding:4px 12px;background:#ff7a00;
    border-radius:8px;color:white;
    text-decoration:none;font-weight:700;
    transition:0.2s;
}
.register-box a:hover{background:#ff9831;}
</style>
</head>

<body>

<div class="login-container">
    <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>

    <form id="loginForm" onsubmit="return false;">
        <input type="email" id="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" autocomplete="email">
        <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" autocomplete="current-password">

        <a class="forgot" href="forgot.html">‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô?</a>

        <button type="submit" onclick="login()">Login</button>

        <div class="register-box">
            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ? <a href="register.html">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
        </div>
    </form>
</div>

<script>


const API_BASE =
    location.hostname === "localhost"
        ? "http://localhost:3000"
        : "https://washingtondc-tour-clean.onrender.com";

async function login() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!email || !password)
        return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö üòé");

    try {
        const res = await fetch(`${API_BASE}/api/auth/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password })
        });

        const data = await res.json();

        if (data.status === "success") {
            localStorage.setItem("token", data.token);
            localStorage.setItem("user", JSON.stringify(data.user));
            return location.href = "index.html";
        }

        alert(data.message || "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î!");

    } catch (err) {
        console.error(err);
        alert("üö® ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏±‡∏ö");
    }
}

// ‚úÖ Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Login (UX ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô)
document.getElementById("loginForm").addEventListener("keypress", e => {
    if (e.key === "Enter") login();
});
</script>

</body>
</html>
