<!DOCTYPE html>
<html lang="th">
<head>

<!-- ‚úÖ Google Analytics: WashingtonDC-Tour -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VGBZS316J9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-VGBZS316J9');
</script>


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forgot Password | Washington D.C.</title>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:'Kanit',sans-serif;
    height:100vh; display:flex; justify-content:center; align-items:center;
    overflow:hidden; position:relative;
}
.bg{
    position:fixed; inset:0;
    background:url("pic/dc_sunset.png") center/cover no-repeat;
    z-index:-2;
}
.overlay{
    position:fixed; inset:0;
    background:rgba(0,0,0,0.35);
    backdrop-filter:blur(2px);
    z-index:-1;
}
.box{
    width:410px; background:rgba(10,0,25,0.85);
    padding:36px; border-radius:24px; text-align:center; color:white;
    box-shadow:0 0 40px rgba(255,140,30,.35);
}
h2{
    font-size:30px; margin-bottom:16px; font-weight:800;
    background:linear-gradient(90deg,#ffd089,#ff8a25);
    -webkit-background-clip:text; color:transparent;
    text-shadow:0 0 10px rgba(255,140,50,0.4);
}
input{
    width:100%; padding:12px; margin:10px 0;
    border-radius:10px; border:none; font-size:17px; color:#222;
}
button{
    width:100%; padding:12px;
    background:linear-gradient(90deg,#ffe29c,#ff8522);
    border:none; border-radius:12px; font-size:18px; font-weight:bold;
    cursor:pointer; margin-top:10px; color:#222; transition:.25s;
}
button:hover{ transform:scale(1.05); box-shadow:0 0 18px rgba(255,160,50,0.65); }
a{ display:inline-block; margin-top:14px; font-size:15px; color:#ffd28a; text-decoration:none; }
.small { font-size:13px; opacity:.9; margin-top:8px; }
</style>
</head>
<body>

<div class="bg"></div>
<div class="overlay"></div>

<div class="box">
    <h2>‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
    <input type="email" id="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ" autocomplete="email" />
    <button id="sendBtn" onclick="sendReset()">‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
    <div class="small">‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï (‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ô‡∏≤‡∏ó‡∏µ)</div>
    <a href="login.html">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ Login</a>
</div>

<script>
localStorage.removeItem("token");
localStorage.removeItem("user");

const API_BASE =
    location.hostname === "localhost"
        ? "http://localhost:3000"
        : "https://washingtondc-tour-clean.onrender.com";

function isEmail(s){
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s);
}

async function sendReset(){
    const email = document.getElementById("email").value.trim();
    const btn = document.getElementById("sendBtn");

    if(!email) return alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•");
    if(!isEmail(email)) return alert("‚ö†Ô∏è ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");

    btn.disabled = true;
    const oldText = btn.textContent;
    btn.innerHTML = `<span class="loader"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...`;

    try {
        const res = await fetch(`${API_BASE}/api/auth/forgot`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email })
        });

        const data = await res.json().catch(()=>null);

        if(data?.status === "success"){
            alert("‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‚úâÔ∏è");
            return setTimeout(() => location.href="login.html", 1200);
        }

        alert(data?.message || "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏î‡πâ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");

    } catch(err){
        console.error(err);
        alert("üö® ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    } finally {
        btn.disabled = false;
        btn.textContent = oldText;
    }
}
</script>

</body>
</html>
