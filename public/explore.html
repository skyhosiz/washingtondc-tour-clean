<!DOCTYPE html>

<html lang="th">
  <head>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Explore D.C. | Washington D.C.</title>

    <script src="js/auth.js"></script>

    <script src="js/nav.js" defer></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-VGBZS316J9"
    ></script>

    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }

      gtag("js", new Date());

      gtag("config", "G-VGBZS316J9");
    </script>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Kanit", sans-serif;

        background: radial-gradient(circle, #1c1a33, #0b0814);

        color: white;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;

        margin: auto;

        padding: 100px 24px 40px;
      }

      .page-title {
        font-size: 36px;

        background: linear-gradient(90deg, #ffd089, #ff8a25);

        color: transparent;

        margin-bottom: 24px;

        border-bottom: 2px solid rgba(255, 150, 60, 0.45);

        padding-bottom: 10px;
      }

      #loadingState {
        font-size: 20px;

        text-align: center;

        margin-top: 40px;
      }

      #exploreGrid {
        display: grid;

        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));

        gap: 24px;
      }

      .explore-card {
        background: rgba(255, 255, 255, 0.08);

        border-radius: 16px;

        box-shadow: 0 0 15px rgba(255, 150, 60, 0.3);

        overflow: hidden;

        transition: transform 0.25s;
      }

      .explore-card:hover {
        transform: translateY(-5px);
      }

      .explore-card img {
        width: 100%;

        height: 220px;

        object-fit: cover;

        border-bottom: 2px solid #ff952e;
      }

      .card-content {
        padding: 20px;
      }

      .explore-card h3 {
        font-size: 20px;

        margin-bottom: 8px;

        overflow: hidden;

        text-overflow: ellipsis;

        white-space: nowrap;
      }

      .explore-card p {
        font-size: 16px;

        color: #ccc;

        font-weight: 300;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1 class="page-title">Explore D.C. Attractions</h1>

      <div id="exploreGrid"></div>

      <p id="loadingState">Loading data...</p>
    </div>

    <script>
      const API_BASE =
        location.hostname === "localhost"
          ? "http://localhost:3000"
          : "https://washingtondc-tour-clean.onrender.com";

      document.addEventListener("DOMContentLoaded", () => {
        loadExploreData();
      });

      async function loadExploreData() {
        const token = localStorage.getItem("token");

        const grid = document.getElementById("exploreGrid");

        const loading = document.getElementById("loadingState");

        try {
          const res = await fetch(`${API_BASE}/api/explore`, {
            headers: { Authorization: `Bearer ${token}` },
          });

          const data = await res.json();

          if (data.status === "success" && data.data.rows.length > 0) {
            loading.style.display = "none";

            data.data.rows.forEach((item) => {
              const title = item.title || "Untitled Artwork";

              const museum = item.content.unitCode || "Smithsonian Institution";

              let imageUrl = "pic/default.png";

              if (
                item.content.descriptiveNonstandardDate?.online_media?.resources
                  ?.thumbnail?.url
              ) {
                imageUrl =
                  item.content.descriptiveNonstandardDate.online_media.resources
                    .thumbnail.url;
              }

              const card = document.createElement("div");

              card.className = "explore-card";

              card.innerHTML = `

          <img src="${imageUrl}" alt="${title}">

          <div class="card-content">

            <h3>${title}</h3>

            <p>${museum}</p>

          </div>

        `;

              grid.appendChild(card);
            });
          } else {
            loading.textContent = "No data found or error.";
          }
        } catch (err) {
          console.error("Fetch Error:", err);

          loading.textContent = "âš  Failed to load resources.";
        }
      }
    </script>
  </body>
</html>
